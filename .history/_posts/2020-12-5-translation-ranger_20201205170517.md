---
title: Translation Ranger：针对连续性感知TLB的操作系统支持
author: Weizhou Huang
tags:
 - virtual memory
 - huge pages
 - TLB miss
---

# Translation Ranger: Operating System Support for Contiguity-Aware TLBs

[文章来源](https://www.cs.yale.edu/homes/abhishek/ziyan-isca19.pdf) 

本文提供了一种通过迁移物理内存页来生成连续性映射的机制，用于提升连续性感知的TLB生成大页映射的概率，以提升TLB缓存和内存地址转换效率。

## 背景和问题：
虚拟内存机制简化了编程，它抽象了物理内存的复杂性，提供了内存保护和进程隔离，使核之间的通信变得更加容易
如图所示，虚拟内存如今不仅用于CPU，还被GPU以及其他硬件加速器采用，图中任何一种硬件设备都可以通过虚拟内存机制访问整个物理内存空间。
由于内存地址的转换需要查询内存页表，这会带来很高的开销，因此诞生了TLB硬件，用以缓存页表项，加速地址转换
现在的CPU在每个核中实现了一个TLB，并且通常每个TLB只缓存一部分内存空间对应的映射信息。

另一方面，当多个连续的4kb虚拟页映射到多个连续的物理页时，新型的连续性感知的TLB能够自动合并多个这样的映射条目为一个，从而增加TLB命中率
如右图所示，左侧是连续性感知的TLB，右侧是传统的TLB，可以看到V0-V3的映射以及V12-V15的映射由于他们对应的物理页也是连续的，所以被连续性感知 的TLB合并成了两个条目。
如左图所示，相比于传统TLB，新型的连续性感知的TLB可以用过将多个4KB映射为条目合并成为一个，使一个条目覆盖的内存段大小远超传统TLB，从而减少映射条目数量，增加TLB命中率

因此为了能够进一步提升虚拟内存机制的地址转换效率，许多研究提出通过创造逻辑到物理地址映射的连续性以充分利用这种连续性感知的TLB 减少映射条目数量，实现更高的地址转换效率
